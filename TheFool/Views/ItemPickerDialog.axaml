<Window xmlns="https://github.com/avaloniaui"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        mc:Ignorable="d" d:DesignWidth="900" d:DesignHeight="600"
        x:Class="TheFool.Views.ItemPickerDialog"
        Title="{Binding Title}"
        Width="900"
        Height="600"
        WindowStartupLocation="CenterOwner"
        CanResize="False">
    
    <DockPanel Margin="20">
        <!-- Search bar -->
        <DockPanel DockPanel.Dock="Top" Margin="0,0,0,15">
            <TextBlock Text="🔍" 
                      DockPanel.Dock="Left" 
                      VerticalAlignment="Center"
                      FontSize="20"
                      Margin="0,0,10,0"/>
            <TextBox Name="SearchBox"
                    Text="{Binding SearchText}"
                    Watermark="Search items..."
                    FontSize="16"/>
        </DockPanel>

        <!-- Bottom buttons -->
        <StackPanel DockPanel.Dock="Bottom" 
                   Orientation="Horizontal"
                   HorizontalAlignment="Right"
                   Spacing="10"
                   Margin="0,15,0,0">
            <Button Name="CancelButton" 
                   Content="Cancel" 
                   Width="100"
                   Click="OnCancelClick"/>
        </StackPanel>

        <!-- Main content -->
        <ScrollViewer>
            <ItemsControl ItemsSource="{Binding Categories}">
                <ItemsControl.ItemTemplate>
                    <DataTemplate>
                        <StackPanel Margin="0,0,0,20">
                            <!-- Category header -->
                            <Border Background="LightGray"
                                   CornerRadius="5"
                                   Padding="10,5"
                                   Margin="0,0,0,10">
                                <TextBlock Text="{Binding Name}" 
                                         FontWeight="Bold"
                                         FontSize="16"/>
                            </Border>
                            
                            <!-- Items grid -->
                            <ItemsControl ItemsSource="{Binding Items}">
                                <ItemsControl.ItemsPanel>
                                    <ItemsPanelTemplate>
                                        <WrapPanel Orientation="Horizontal"/>
                                    </ItemsPanelTemplate>
                                </ItemsControl.ItemsPanel>
                                <ItemsControl.ItemTemplate>
                                    <DataTemplate>
                                        <Button Name="ItemButton"
                                               Click="OnItemClick"
                                               Tag="{Binding Name}"
                                               Margin="5"
                                               Width="140"
                                               Height="160"
                                               Padding="10"
                                               Background="White"
                                               BorderBrush="Gray"
                                               BorderThickness="2">
                                            <Button.Styles>
                                                <Style Selector="Button:pointerover">
                                                    <Setter Property="Background" Value="LightBlue"/>
                                                    <Setter Property="BorderBrush" Value="Blue"/>
                                                </Style>
                                            </Button.Styles>
                                            <StackPanel>
                                                <!-- Icon/Image -->
                                                <Border Width="80" 
                                                       Height="80" 
                                                       Background="LightGray"
                                                       CornerRadius="10"
                                                       Margin="0,0,0,8">
                                                    <TextBlock Text="{Binding Icon}"
                                                             FontSize="40"
                                                             HorizontalAlignment="Center"
                                                             VerticalAlignment="Center"/>
                                                </Border>
                                                
                                                <!-- Name -->
                                                <TextBlock Text="{Binding Name}"
                                                         FontWeight="SemiBold"
                                                         TextAlignment="Center"
                                                         TextWrapping="Wrap"
                                                         FontSize="12"
                                                         Margin="0,0,0,4"/>
                                                
                                                <!-- Description tooltip -->
                                                <ToolTip.Tip>
                                                    <Border Background="White"
                                                           BorderBrush="Gray"
                                                           BorderThickness="1"
                                                           CornerRadius="5"
                                                           Padding="10"
                                                           MaxWidth="300">
                                                        <StackPanel>
                                                            <TextBlock Text="{Binding Name}"
                                                                     FontWeight="Bold"
                                                                     FontSize="14"
                                                                     Margin="0,0,0,5"/>
                                                            <TextBlock Text="{Binding Description}"
                                                                     TextWrapping="Wrap"
                                                                     FontSize="12"/>
                                                        </StackPanel>
                                                    </Border>
                                                </ToolTip.Tip>
                                            </StackPanel>
                                        </Button>
                                    </DataTemplate>
                                </ItemsControl.ItemTemplate>
                            </ItemsControl>
                        </StackPanel>
                    </DataTemplate>
                </ItemsControl.ItemTemplate>
            </ItemsControl>
        </ScrollViewer>
    </DockPanel>
</Window>
